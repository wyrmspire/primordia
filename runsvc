#!/usr/bin/env bash
set -euo pipefail
SVC=${1:-svc1}
DATA=$(printf '{"type":"SERVICE_DEPLOYED","name":"%s"}' "$SVC" | base64 | tr -d '\n')
curl -sS -X POST "http://localhost:8083/v1/projects/ticktalk-472521/topics/primordia-local-events:publish" \
  -H "Content-Type: application/json" \
  -d "{\"messages\":[{\"data\":\"$DATA\"}]}" >/dev/null
echo "event sent for $SVC"
